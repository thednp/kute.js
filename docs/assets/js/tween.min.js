(function(e,t){typeof exports==`object`&&typeof module<`u`?t(exports):typeof define==`function`&&define.amd?define([`exports`],t):(e=typeof globalThis<`u`?globalThis:e||self,t(e.DNPTWEEN={}))})(this,function(e){let t=e=>typeof e==`string`,n=e=>typeof e==`number`,r=e=>Array.isArray(e),i=e=>typeof e==`function`,a=e=>typeof e==`object`&&!!e&&Object.getPrototypeOf(e)===Object.prototype,o=e=>a(e)&&!r(e),s=e=>o(e)&&Object.values(e).some(o);function c(e,t){let n=Object.keys(t),r=0,i=n.length;for(;r<i;){let i=n[r++],a=t[i];typeof a==`object`?Object.assign(e[i],a):e[i]=a}}function l(e,t){let i=this.getErrors();if(!o(e)||Object.keys(e).length===0){i.set(`init`,`Initialization value is empty or not an object.`);return}let a=Object.keys(e);if(t&&a.some(e=>i.has(e)))return;let s=0;for(;s<a.length;){let o=a[s++],c=t?.[o],l=e[o];if(n(l))continue;if(l==null){i.set(o,`Property "${o}" is null/undefined.`);continue}if(t&&c===void 0){i.set(o,`Property "${o}" doesn't exist in state yet.`);continue}let u=this.getValidator(o);if(u){let[e,t]=u(o,l,c);e?i.delete(o):i.set(o,t);continue}if(t&&n(c)){n(l)||i.set(o,`Property "${o}" is not a number.`);continue}i.set(o,`Property "${o}" of type "${r(l)?`array`:typeof l}" is not supported yet.`)}i.delete(`init`)}let u=()=>globalThis.performance.now(),d=()=>u();function f(e){u=e}let p=[],m=0,h=0;function g(e=d()){let t=0;for(h=p.length;t<h;)p[t].update(e)?t+=1:(p.splice(t,1),--h);h===0?(cancelAnimationFrame(m),m=0):m=requestAnimationFrame(g)}function _(e){let t=e;p.push(t),m||g()}function v(e){p.splice(p.indexOf(e),1),h--}var y=class{state;_state;_startIsSet=!1;_repeat=0;_yoyo=!1;_reversed=!1;_initialRepeat=0;_startFired=!1;_propsStart={};_propsEnd={};_isPlaying=!1;_duration=1e3;_delay=0;_startTime=0;_errors=new Map;_interpolators=new Map;_validators=new Map;_easing=e=>e;_onUpdate;_onComplete;_onStart;_onStop;_runtime=[];constructor(e){return this.state={},l.call(this,e),this._errors.size?this._state=e:(this.state=e,this._state={...e}),this}get isPlaying(){return this._isPlaying}get isValidState(){return Object.keys(this.state).length>0}get isValid(){return this._errors.size===0}getDuration(){return this._duration/1e3}getValidator(e){return this._validators.get(e)}getErrors(){return this._errors}start(e=d(),t=!1){return this._isPlaying?this:this.isValid?((!this._startIsSet||t)&&(this._startIsSet=!0,this._setProps(this.state,this._propsStart,this._propsEnd,t)),this._isPlaying=!0,this._startTime=e,this._startTime+=this._delay,_(this),this):(this._report(),this)}startFromLast(e=d()){return this.start(e,!0)}stop(){return this._isPlaying?(v(this),this._isPlaying=!1,this._onStop?.(this.state),this):this}from(e){return!this.isValidState||this.isPlaying?this:(this._evaluate(e),this.isValid&&(Object.assign(this._propsStart,e),this._startIsSet=!1),this)}to(e){return!this.isValidState||this.isPlaying?this:(this._evaluate(e),this.isValid&&(this._propsEnd=e,this._startIsSet=!1),this)}duration(e=1){return this._duration=e*1e3,this}delay(e=0){return this._delay=e*1e3,this}repeat(e=0){return this._repeat=e,this._initialRepeat=e,this}yoyo(e=!1){return this._yoyo=e,this}easing(e=e=>e){return this._easing=e,this}onStart(e){return this._onStart=e,this}onUpdate(e){return this._onUpdate=e,this}onComplete(e){return this._onComplete=e,this}onStop(e){return this._onStop=e,this}update(e=d(),t){if(!this._isPlaying)if(t)this.start(e,!0);else return!1;if(e<this._startTime)return!0;!this._startFired&&this._onStart&&(this._onStart(this.state),this._startFired=!0);let n=(e-this._startTime)/this._duration;n=n>1?1:n;let r=this._easing(n);r=this._reversed?1-r:r;let i=0,a=this._runtime,o=this.state,s=a.length;for(;i<s;){let[e,t,n,s,c]=a[i++];typeof c==`number`?o[t]=s+(c-s)*r:n&&n(e,s,c,r)}return this._onUpdate?.(this.state,n),n===1?this._repeat===0?(this._isPlaying=!1,this._repeat=this._initialRepeat,this._reversed=!1,this._onComplete?.(this.state),!1):(this._repeat!==1/0&&this._repeat--,this._yoyo&&(this._reversed=!this._reversed),this._startTime=e,!0):!0}use(e,{interpolate:t,validate:n}){return t&&!this._interpolators.has(e)&&this._interpolators.set(e,t),n&&!this._validators.has(e)&&this._validators.set(e,n),this._evaluate(),this}_setProps(e,t,n,i){this._runtime.length=0;let o=Object.keys(n),s=o.length,c=0;for(;c<s;){let s=o[c++];if(t[s]===void 0||i){let i=e[s],o=a(i)?{...i}:r(i)?i.slice(0):i;t[s]=o;let c=this._interpolators.get(s)||null;this._runtime.push([e[s],s,c,o,n[s]])}}}_evaluate(e){if(this.isValidState)e&&l.call(this,e,this._state);else{let e=this._state;l.call(this,e),this.isValid&&(this.state=e,this._state={...e})}return this}_report(){if(!this.isValid){let e=[`[Tween] failed validation:`,`- `+Array.from(this._errors.values()).join(`
- `)];console.warn(e.join(`
`))}return this}},b=class{state;_state;_entries=[];_labels=new Map;_progress=0;_duration=0;_time=0;_pauseTime=0;_lastTime;_isPlaying=!1;_repeat=0;_initialRepeat=0;_errors=new Map;_interpolators=new Map;_validators=new Map;_onStart;_onStop;_onPause;_onResume;_onUpdate;_onComplete;constructor(e){return this.state={},l.call(this,e),this._errors.size?this._state=e:(this.state=e,this._state={...e}),this}get progress(){return this._progress}get duration(){return this._duration/1e3}get totalDuration(){return this._duration*(this._initialRepeat||1)/1e3}get isPlaying(){return this._isPlaying}get isPaused(){return!this._isPlaying&&this._pauseTime>0}get isValidState(){return Object.keys(this.state).length>0}get isValid(){return this._errors.size===0}getValidator(e){return this._validators.get(e)}getErrors(){return this._errors}play(){return this._pauseTime?this.resume():this._isPlaying?this:this.isValid?(this._isPlaying=!0,this._lastTime=void 0,this._time=0,this._resetState(),this._updateEntries(0),this._onStart?.(this.state,0),_(this),this):(this._report(),this)}pause(){return this._isPlaying?(this._isPlaying=!1,this._pauseTime=d(),this._onPause?.(this.state,this.progress),this):this}resume(e=d()){if(this._isPlaying)return this;this._isPlaying=!0;let t=e-this._pauseTime;return this._pauseTime=0,this._lastTime=(this._lastTime||e)+t,this._onResume?.(this.state,this.progress),_(this),this}stop(){return this._isPlaying?(this._isPlaying=!1,this._time=0,this._pauseTime=0,v(this),this._resetState(),this._updateEntries(0),this._onStop?.(this.state,this._progress),this):this}repeat(e=0){return this._repeat=e,this._initialRepeat=e,this}seek(e){let t=this._resolvePosition(e);return this._resetState(),this._time=Math.max(0,t),this._updateEntries(this._time),this}label(e,t){return this._labels.set(e,this._resolvePosition(t)),this}to({duration:e=1,easing:t=e=>e,...n},r=`+=0`){if(!this.isValidState)return this;if(this._evaluate(n),this.isValid){let i=this._resolvePosition(r),a=n,o=e*1e3;this._entries.push({from:{},to:a,runtime:[],startTime:i,duration:o,easing:t,hasStarted:!1});let s=i+o;this._duration=Math.max(this._duration,s)}return this}onStart(e){return this._onStart=e,this}onPause(e){return this._onPause=e,this}onResume(e){return this._onResume=e,this}onStop(e){return this._onStop=e,this}onUpdate(e){return this._onUpdate=e,this}onComplete(e){return this._onComplete=e,this}update(e=d()){if(!this._isPlaying)return!1;this._lastTime===void 0&&(this._lastTime=e);let t=e-this._lastTime;return this._lastTime=e,this._time+=t,this._updateEntries(this._time),this._progress===1&&(this._repeat===0?(this._isPlaying=!1,this._repeat=this._initialRepeat,this._onComplete?.(this.state,1)):(this._repeat!==1/0&&this._repeat--,this._time=0,this._resetState(),this._updateEntries(0))),this._isPlaying}_updateEntries(e){this._progress=this._duration===0||e>=this._duration?1:e/this._duration;let t=0,n=this._entries,r=this.state,i=n.length;for(;t<i;){let i=n[t++],a=e-i.startTime,o=Math.max(0,Math.min(1,a/i.duration));if(!i.hasStarted&&o>0&&this._setEntry(i),i.hasStarted){let e=i.easing(o),t=i.runtime.length,n=0;for(;n<t;){let[t,a,o,s,c]=i.runtime[n++];typeof c==`number`?r[a]=s+(c-s)*e:o&&o(t,s,c,e)}}}this._onUpdate&&this._onUpdate(this.state,this._progress)}_resolvePosition(e){if(typeof e==`number`)return e*1e3;if(typeof e==`string`){let t=this._labels.get(e);if(t!==void 0)return t;if(e.startsWith(`+=`)||e.startsWith(`-=`)){let t=parseFloat(e.slice(2));return isNaN(t)&&(t=0),t*=1e3,e.startsWith(`+=`)?this._duration+t:Math.max(0,this._duration-t)}}return this._duration}_setEntry(e){e.hasStarted=!0,e.from={},e.runtime.length=0;let t=Object.keys(e.to),n=t.length,i=this.state,o=0;for(;o<n;){let n=t[o++],s=i[n],c=a(s)?{...s}:r(s)?s.slice(0):s;e.from[n]=c;let l=this._interpolators.get(n)||null;e.runtime.push([i[n],n,l,c,e.to[n]])}}_resetState(){Object.assign(this.state,this._state);let e=0,t=this._entries.length;for(;e<t;){let t=this._entries[e];t.hasStarted=!1,t.from=void 0,t.runtime.length=0,e+=1}}clear(){return this._entries.length=0,this._duration=0,this._labels.clear(),this._time=0,this._progress=0,this._pauseTime=0,this._lastTime=void 0,this._repeat=this._initialRepeat,this}use(e,{interpolate:t,validate:n}){return t&&!this._interpolators.has(e)&&this._interpolators.set(e,t),n&&!this._validators.has(e)&&this._validators.set(e,n),this._evaluate(),this}_evaluate(e){if(this.isValidState)e&&l.call(this,e,this._state);else{let e=this._state;l.call(this,e),this.isValid&&(this.state=e,this._state={...e})}return this}_report(){if(!this.isValid){let e=[`[Timeline] failed validation:`,`- `+Array.from(this._errors.values()).join(`
- `)].join(`
`);console.warn(e)}return this}};let x=Object.freeze({Linear:Object.freeze({None(e){return e},In(e){return e},Out(e){return e},InOut(e){return e}}),Quadratic:Object.freeze({In(e){return e*e},Out(e){return e*(2-e)},InOut(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In(e){return e*e*e},Out(e){return--e*e*e+1},InOut(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In(e){return e*e*e*e},Out(e){return 1- --e*e*e*e},InOut(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In(e){return e*e*e*e*e},Out(e){return--e*e*e*e*e+1},InOut(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In(e){return 1-Math.sin((1-e)*Math.PI/2)},Out(e){return Math.sin(e*Math.PI/2)},InOut(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In(e){return e===0?0:1024**(e-1)},Out(e){return e===1?1:1-2**(-10*e)},InOut(e){return e===0?0:e===1?1:(e*=2)<1?.5*1024**(e-1):.5*(-(2**(-10*(e-1)))+2)}}),Circular:Object.freeze({In(e){return 1-Math.sqrt(1-e*e)},Out(e){return Math.sqrt(1- --e*e)},InOut(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In(e){return e===0?0:e===1?1:-(2**(10*(e-1)))*Math.sin((e-1.1)*5*Math.PI)},Out(e){return e===0?0:e===1?1:2**(-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*2**(10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*2**(-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In(e){let t=1.70158;return e===1?1:e*e*((t+1)*e-t)},Out(e){let t=1.70158;return e===0?0:--e*e*((t+1)*e+t)+1},InOut(e){let t=1.70158*1.525;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In(e){return 1-x.Bounce.Out(1-e)},Out(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut(e){return e<.5?x.Bounce.In(e*2)*.5:x.Bounce.Out(e*2-1)*.5+.5}}),pow(e=4){return e=e<2**-52?2**-52:e,e=e>1e4?1e4:e,{In(t){return t**e},Out(t){return 1-(1-t)**e},InOut(t){return t<.5?(t*2)**e/2:(1-(2-t*2)**e)/2+.5}}}});var S=`0.0.2`;let C=(e,t,n,r)=>{e.length=0;let i=n.length,a=0;for(;a<i;)e.push(t[a]+(n[a]-t[a])*r),a+=1;return e},w=e=>r(e)&&e.every(n),T=(e,t,n)=>r(t)?w(t)?n&&n.length!==t.length?[!1,`Property "${String(e)}" is expecting an array of ${n.length} numbers.`]:[!0]:[!1,`Property "${String(e)}" is not a valid Array<number>.`]:[!1,`Property "${String(e)}" is not Array.`],E={interpolate:C,validate:T},D=(e,t)=>{let n=t>=1?10**t:1;return t>0?Math.round(e*n)/n:Math.round(e)};function O(e,t=4){let n=e.length,r=e[0],i=r.slice(1),a=``,o=0;for(;o<n;){r=e[o++],a+=r[0],i=r.slice(1);let n=0,s=i.length;for(;n<s;)a+=D(i[n],t),n!==s-1&&(a+=` `),n+=1}return a}let k=(e,t,n,r)=>{e.length=0;let i=n.length,a=0;for(;a<i;){let[i,o]=[t[a][0],t[a].slice(1)],[s,c]=[n[a][0],n[a].slice(1)];if(i===`Z`)e.push([`Z`]);else{let t=[],n=c.length,i=0;for(;i<n;)t.push(o[i]+(c[i]-o[i])*r),i+=1;e.push([s,...t])}a++}return e},A=[`M`,`L`,`C`,`Z`],j=e=>r(e)&&e.some(e=>r(e)&&A.includes(e[0])),M=e=>j(e)&&e.length>1&&e.every(r)&&e.every(([e,...t])=>A.includes(e)&&([`M`,`L`].includes(e)&&t.length===2&&t.every(n)||e===`C`&&t.length===6&&t.every(n)||e===`Z`&&t.length===0)),N=(e,t,n)=>{if(!M(t))return[!1,`Property "${e}" is not a valid PathArray.`];if(n){if(n.length!==t.length)return[!1,`Property "${e}" is expecting an array of ${n.length} path segments, got ${t.length}.`];let r=0,i=n.length;for(;r<i;){let[i,a]=[n[r][0],n[r].slice(1)],[o,s]=[t[r][0],t[r].slice(1)],c=i!==o;if(a.length!==s.length||c)return[!1,`Property "${e}" mismatch at index ${r}. Segments don't match:
 > segment: "[`+o+`, `+s+`]"
 > reference: "[`+i+`, `+a+`]"`];r+=1}}return[!0]},P={interpolate:k,validate:N},F=(e,t,n,r)=>{let i=Object.keys(n),a=0;for(;a<i.length;){let o=i[a++],s=n[o],c=t[o];e[o]=c+(s-c)*r}return e},I=(e,t,r)=>{if(!o(t))return[!1,`Property "${e}" must be a plain object.`];let i=Object.keys(t),a=0,s=i.length;for(;a<s;){let s=i[a++],c=t[s];if(c==null)return[!1,`Property "${s}" from "${e}" is null/undefined.`];if(!n(c))return[!1,`Property "${s}" from "${e}" must be a number.${o(c)?` Deeper nested objects are not supported.`:` Unsupported value: "${typeof c}".`}`];if(r&&r[s]===void 0)return[!1,`Property "${s}" in "${e}" doesn't exist in the reference object.`]}return[!0]},L={interpolate:F,validate:I},R=(e,t=!1)=>{if(t){let t=new DOMMatrix,n=e.length,r=0;for(;r<n;){let n=e[r++];switch(n[0]){case`perspective`:{let e=new DOMMatrix;e.m34=-1/n[1],t.multiplySelf(e);break}case`translate`:t.translateSelf(...n.slice(1));break;case`rotate`:t.rotateSelf(...n.slice(1));break;case`rotateAxisAngle`:t.rotateAxisAngleSelf(...n.slice(1));break;case`scale`:t.scaleSelf(...n.slice(1));break;case`skewX`:t.skewXSelf(n[1]);break;case`skewY`:t.skewYSelf(n[1]);break}}return t.toString()}let n=e.length,r=0,i=[];for(;r<n;){let t=e[r++];switch(t[0]){case`perspective`:i.push(`perspective(${t[1]}px)`);break;case`translate`:{let[e,n,r]=t.slice(1),a=`${e}px`,o=n===void 0?`0px`:`${n}px`,s=r===void 0?`0px`:`${r}px`;i.push(`translate3d(${a}, ${o}, ${s})`);break}case`rotate`:{let[e,n,r]=t.slice(1);typeof e==`number`&&n===void 0&&r===void 0?i.push(`rotate(${e}deg)`):(i.push(`rotateX(${e}deg)`),n!==void 0&&i.push(`rotateY(${n}deg)`),r!==void 0&&i.push(`rotateZ(${r}deg)`));break}case`rotateAxisAngle`:{let[e,n,r,a]=t.slice(1);i.push(`rotate3d(${e}, ${n}, ${r}, ${a}deg)`);break}case`scale`:{let[e,n,r]=t.slice(1);i.push(`scale(${e}, ${n||e}, ${r||1})`);break}case`skewX`:i.push(`skewX(${t[1]}deg)`);break;case`skewY`:i.push(`skewY(${t[1]}deg)`);break}}return i.join(` `)},z=(e,t,n)=>{let r=[e[0]+(t[0]-e[0])*n];return e[1]!==void 0&&t[1]!==void 0&&r.push(e[1]+(t[1]-e[1])*n),e[2]!==void 0&&t[2]!==void 0&&r.push(e[2]+(t[2]-e[2])*n),r},B=(e,t,n)=>[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n,e[2]+(t[2]-e[2])*n,e[3]+(t[3]-e[3])*n],V=(e,t,n,r)=>{e.length=0;let i=n.length,a=0;for(;a<i;){let i=t[a],o=n[a];a++;let s=o[0],c=i.slice(1),l=o.slice(1);switch(s){case`translate`:case`rotate`:case`scale`:e.push([s,...z(c,l,r)]);break;case`rotateAxisAngle`:e.push([s,...B(c,l,r)]);break;case`skewX`:case`skewY`:case`perspective`:e.push([s,c[0]+(l[0]-c[0])*r]);break}}return e},H=[`perspective`,`translate`,`rotate`,`rotateAxisAngle`,`scale`,`skewX`,`skewY`],U=e=>r(e)&&e.some(e=>r(e)&&H.includes(e[0])),W=e=>U(e)&&e.every(([e,...t])=>H.includes(e)&&([`translate`,`rotate`,`scale`].includes(e)&&t.length>0&&t.length<=3&&t.every(n)||e===`rotateAxisAngle`&&t.length===4&&t.every(n)||[`skewX`,`skewY`,`perspective`].includes(e)&&t.length===1&&n(t[0]))),G=(e,t,n)=>{if(!W(t))return[!1,`Property "${e}" must be an array of TransformStep.`];if(n&&n.length!==t.length)return[!1,`Property "${e}" is expecting an array of ${n.length} transform steps, got ${t.length}.`];let r=0,i=t.length;for(;r<i;){let i=t[r],a=n?.[r],o=i[0],s=i.slice(1);if(a&&(a[0]!==o||a.length!==i.length))return[!1,`Property "${e}" mismatch at index ${r}":\n> step: ["${o}", ${s.map(e=>typeof e)}]\n> reference: ["${a[0]}", ${a.slice(1).map(e=>typeof e)}]`];r++}return[!0]},K={interpolate:V,validate:G};e.Easing=x,e.Queue=p,e.Runtime=g,e.Timeline=b,e.Tween=y,e.addToQueue=_,e.arrayConfig=E,e.deepMerge=c,e.interpolateArray=C,e.interpolateObject=F,e.interpolatePath=k,e.interpolateTransform=V,e.isArray=r,e.isDeepObject=s,e.isFunction=i,e.isNumber=n,e.isObject=a,e.isPathLike=j,e.isPlainObject=o,e.isString=t,e.isTransformLike=U,e.isValidArray=w,e.isValidPath=M,e.isValidTransformArray=W,e.now=d,e.objectConfig=L,e.pathArrayConfig=P,e.pathToString=O,e.removeFromQueue=v,e.setNow=f,e.transformConfig=K,e.transformToString=R,e.validateArray=T,e.validateObject=I,e.validatePath=N,e.validateTransform=G,e.validateValues=l,Object.defineProperty(e,`version`,{enumerable:!0,get:function(){return S}})});
//# sourceMappingURL=tween.min.js.map